<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Appointment</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../static/css/style.css" />
    <link rel="stylesheet" href="../static/css/appointment.css" />
    <style>
      body {
        background-image: url("../static/images/appointment.avif");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }

      /* Appointment Box Hover Effect */
      .form-data {
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        background-color: #a2b5ba;
        border: 2px solid transparent;
      }

      .form-data:hover {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border-color: #00637f;
        /* Highlighted border color */
      }

      /* Disable dates beyond 15 days in Appointment Date */
      #dateInput::-webkit-calendar-picker-indicator {
        color: transparent;
      }
    </style>
  </head>

  <body>
    <section class="header">
      <nav class="navbar navbar-expand-lg sticky-navbar" style="background-color: #00637f" data-bs-theme="dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">
            <img src="../static/images/delhi.png" alt="Delhi Logo" class="rounded-circle" width="40" height="40" />
          </a>
          <h3 class="mehran">Government of NCT of Delhi</h3>
          <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav ms-auto justify-content-end navbar1">
              <li class="nav-item mr-3">
                <a class="nav-link text-light" href="/">Home</a>
              </li>
              <li class="nav-item mr-3">
                <a class="nav-link text-light" href="/templates/user login.html">Login</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </section>

    <!-- Appointment Form -->
    <div class="container appointment">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="alert alert-danger">
        {% for category, message in messages %}
        <p>{{ message }}</p>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="form-data">
            <div class="form-head">
              <h2>Book Appointment</h2>
            </div>
            <form method="post" action="/appointment">
              <div class="form-body">
                <!-- Full Name Input -->
                <div class="mb-3">
                  <label for="nameInput" class="form-label">Full Name</label>
                  <input type="text" id="nameInput" placeholder="Enter Full Name" name="name" class="form-control" />
                </div>

                <!-- Mobile Number Input -->
                <div class="mb-3">
                  <label for="numberInput" class="form-label">Mobile Number</label>
                  <input type="text" id="numberInput" placeholder="Enter Mobile Number" name="number"
                    class="form-control" />
                </div>

                <!-- Email Address Input -->
                <div class="mb-3">
                  <label for="emailInput" class="form-label">Email Address</label>
                  <input type="text" id="emailInput" placeholder="Enter Email Address" name="email"
                    class="form-control" />
                </div>

                <!-- Address Input -->
                <div class="mb-3">
                  <label for="addressInput" class="form-label">Address</label>
                  <input type="text" id="addressInput" placeholder="Enter Your Address" name="Address"
                    class="form-control" />
                </div>

                <!-- Appointment Date Input (limited to 15 days) -->
                <div class="mb-3">
                  <label for="dateInput" class="form-label">Appointment Date</label>
                  <input type="date" id="dateInput" name="dat" min="{{ today }}" max="{{ today | add_days(15) }}" <!--
                    Show only next 15 days -->
                  class="form-control"
                  />
                </div>

                <!-- Time Slot Selection -->
                <div class="mb-3">
                  <label for="timeSlot">Select Time Slot:</label>
                  <select id="timeSlot" name="timeSlot" class="form-control">
                    <option value="" disabled selected>Select a time slot</option>
                    <option value="08:00 - 09:00">08:00 - 09:00</option>
                    <option value="09:00 - 10:00">09:00 - 10:00</option>
                    <!-- Other time slots... -->
                  </select>
                </div>

                <!-- Speciality Selection -->
                <div class="mb-3">
                  <label for="diseaseInput">Select Speciality:</label>
                  <select id="diseaseInput" name="diseaseInput" class="form-control">
                    <option value="" disabled selected>Select an option</option>
                    <option value="Medicine">Medicine</option>
                    <!-- Other specialities... -->
                  </select>
                </div>

                <!-- Hospital Selection with Dynamic Doctor Update -->
                <div class="form-group">
                  <label for="hospital" class="form-label">Select Hospital</label>
                  <select id="hospital" name="hospital" class="form-control" required>
                    <option value="" disabled selected>Select Hospital</option>
                    {% for hospital in hospitals %}
                    <option value="{{ hospital }}">{{ hospital }}</option>
                    {% endfor %}
                  </select>
                </div>

                <!-- Doctor Selection based on Hospital -->
                <div class="form-group">
                  <label for="doctor" class="form-label">Select Doctor</label>
                  <select id="doctor" name="doctor" class="form-control">
                    <option value="" disabled selected>Select Doctor</option>
                  </select>
                </div>

                <!-- Disease Description -->
                <div class="mb-3">
                  <label for="diseaseDescription">Description Disease:</label>
                  <input type="text" placeholder="Enter Disease Description" name="diseaseDescription"
                    class="form-control" />
                </div>

                <!-- Submit Button -->
                <div class="mb-3 d-flex justify-content-center">
                  <button class="btn btn-success btn-appointment" type="submit">Book Appointment</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery for Doctor Selection -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      $(document).ready(function () {
        // When a hospital is selected, fetch the list of doctors
        $('#hospital').on('change', function () {
          const hospital = $(this).val();

          // Example: Fetch doctors via an API call (Replace with actual data fetching logic)
          $.ajax({
            url: `/get-doctors/${hospital}`, // Endpoint to get doctors based on hospital
            method: 'GET',
            success: function (data) {
              const doctorSelect = $('#doctor');
              doctorSelect.empty();
              doctorSelect.append('<option value="" disabled selected>Select Doctor</option>');
              data.doctors.forEach((doctor) => {
                doctorSelect.append(`<option value="${doctor}">${doctor}</option>`);
              });
            },
          });
        });
      });
    </script>
  </body>

</html>